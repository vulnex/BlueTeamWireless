# =============================================================================
# Kismet Site Configuration - Blue Team Wireless Workshop
# =============================================================================
# Copy to: /etc/kismet/kismet_site.conf
# This file overrides defaults in kismet.conf

# =============================================================================
# DATA SOURCES
# =============================================================================
# Auto-detect and use available WiFi interfaces
# Or specify explicitly:
# source=wlan1:type=linuxwifi,channel=6

# =============================================================================
# LOGGING
# =============================================================================
# Enable all logging types for forensics
log_types=kismet,pcapng,wiglecsv

# Log directory
log_prefix=/var/log/kismet

# =============================================================================
# ALERT CONFIGURATION - DETECTION TUNING
# =============================================================================

# -----------------------------------------------------------------------------
# DENIAL OF SERVICE ALERTS
# -----------------------------------------------------------------------------
# Deauthentication flood (high rate = attack)
alert=DEAUTHFLOOD,10/min,5/sec

# Broadcast disconnect (affects all clients)
alert=BCASTDISCON,10/min,5/sec

# Disassociated client still sending traffic
alert=DISASSCTRAFFIC,10/min,5/sec

# -----------------------------------------------------------------------------
# EVIL TWIN / ROGUE AP ALERTS
# -----------------------------------------------------------------------------
# Advertised encryption changed (possible spoofing)
alert=ADVCRYPTCHANGE,5/min,1/sec

# Beacon rate changed (possible spoofing)
alert=BEACONRATE,5/min,1/sec

# Channel changed for known AP
alert=CHANCHANGE,5/min,1/sec

# Encryption downgrade (WPA2 -> Open)
alert=CRYPTODROP,5/min,1/sec

# BSS timestamp anomalies (cloned AP detection)
alert=BSSTIMESTAMP,5/min,1/sec

# Probe response on different channel
alert=PROBECHAN,5/min,1/sec

# 802.11d country code mismatch
alert=DOT11D,5/min,1/sec

# -----------------------------------------------------------------------------
# KARMA / KNOWN ATTACK TOOLS
# -----------------------------------------------------------------------------
# Karma attack OUI (00:13:37)
alert=KARMAOUI,5/min,1/sec

# Flipper Zero BTLE attacks
alert=FLIPPERZERO,5/min,1/sec

# Bleedingtooth Bluetooth attack
alert=BLEEDINGTOOTH,5/min,1/sec

# -----------------------------------------------------------------------------
# WPS ATTACKS
# -----------------------------------------------------------------------------
# WPS brute force attempts
alert=WPSBRUTE,5/min,1/sec

# -----------------------------------------------------------------------------
# DEVICE TRACKING
# -----------------------------------------------------------------------------
# Alert when specific device appears
alert=DEVICEFOUND,10/min,5/sec

# Alert when specific device disappears
alert=DEVICELOST,10/min,5/sec

# -----------------------------------------------------------------------------
# DRIVER / CLIENT EXPLOITS (Historical, mostly disabled)
# -----------------------------------------------------------------------------
# Format string attacks (iPhone DoS)
alert=FORMATSTRING,5/min,1/sec

# Long SSID overflow attempts
alert=LONGSSID,5/min,1/sec

# WMM overflow (Broadpwn)
alert=WMMOVERFLOW,5/min,1/sec

# KRACK attack (nonce reuse)
alert=NONCEREUSE,5/min,1/sec

# =============================================================================
# APSPOOF CONFIGURATION - WHITELIST LEGITIMATE APs
# =============================================================================
# Define valid MAC addresses for your SSIDs
# Format: apspoof=name:ssid="SSID",validmacs="MAC1,MAC2"
# 
# Uncomment and customize for your environment:

# apspoof=CorpWiFi:ssid="CorpWiFi",validmacs="AA:BB:CC:DD:EE:FF"
# apspoof=CorpGuest:ssid="CorpGuest",validmacs="AA:BB:CC:DD:EE:00"

# Example with MAC mask (match whole OUI):
# apspoof=CorpAll:ssid="CorpWiFi",validmacs="AA:BB:CC:00:00:00/FF:FF:FF:00:00:00"

# =============================================================================
# DEVICE TRACKING - ALERT ON SPECIFIC MACs
# =============================================================================
# Alert when these devices appear (known bad actors, lost devices, etc.)
# 
# Uncomment and customize:
# devicefound=00:13:37:00:00:00/FF:FF:FF:00:00:00
# devicefound=DE:AD:BE:EF:00:00

# =============================================================================
# PERFORMANCE TUNING
# =============================================================================
# Channel hop rate (slower = better detection, faster = better coverage)
# channel_hop_speed=5/sec

# Packet deduplication (0 = disabled, may be needed for deauth detection)
# packets_dedup_size=0

# =============================================================================
# WEB INTERFACE
# =============================================================================
httpd_home=/usr/share/kismet/httpd/

# Allow remote connections (change for production!)
httpd_bind_address=0.0.0.0
httpd_port=2501

# =============================================================================
# SIEM INTEGRATION
# =============================================================================
# Syslog alerts
# alertsyslog=LOG_LOCAL0

# JSON alert output
# alertjson=/var/log/kismet/alerts.json
